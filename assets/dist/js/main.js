!function($){var globalName="FoodTruckGMap",defaultMapOptions={zoom:13,panControl:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1},defaultStyle=[{featureType:"poi.business",stylers:[{visibility:"off"}]}],MapClass=function($dom,options){var _this=this;return this.$container=$dom&&$dom.length?$dom:$("<div />"),this.map=!1,this.options=$.extend(defaultMapOptions,options||{}),this.markers=[],this.map=new window.google.maps.Map(_this.$container[0],_this.options),this.bounds=new google.maps.LatLngBounds,google.maps.InfoWindow.prototype.set=function(){},this.addMarker=function(latlng,icon,clickCallback){if(!this.map)return!1;var opts={position:latlng.length?new google.maps.LatLng(latlng[0],latlng[1]):latlng,map:_this.map};icon&&(opts.icon=icon);var marker=new google.maps.Marker(opts);return this.markers.push(marker),this.bounds.extend(opts.position),this.markers.length>1?this.map.fitBounds(this.bounds):this.map.setCenter(this.bounds.getCenter()),setTimeout(function(){this.map.getZoom()>this.options.zoom&&this.map.setZoom(this.options.zoom)}.bind(this),1e3),clickCallback&&marker.addListener("click",clickCallback),this},this.reset=function(){for(var i=0;i<this.markers.length;i++)this.markers[i].setMap(null);this.markers=[],this.bounds=new google.maps.LatLngBounds},this.setStyle=function(json){return this.map.set("styles",json),this},this.setStyle(defaultStyle),this},readyCallbacks=[],googleMapsInitialising=!1,googleMapsInitialised=!1,onGoogleReady=function(callback){if(googleMapsInitialised)return void callback();if(readyCallbacks.push(callback),!googleMapsInitialising){googleMapsInitialising=!0;var s=document.createElement("script");s.async=!0,s.src="http://maps.googleapis.com/maps/api/js?v=3.exp&callback="+globalName+"._googleMapsReady&key=AIzaSyAcB9Jwud7F5F_fO2BFHCIGswomX5pjKEQ",document.getElementsByTagName("script")[0].appendChild(s)}},exprt={};exprt._googleMapsReady=function(){googleMapsInitialised=!0;for(var i=0;i<readyCallbacks.length;i++)readyCallbacks[i]();readyCallbacks=[]},exprt.ready=function(callback){onGoogleReady(callback)},exprt.create=function($dom,options){if(!googleMapsInitialised)return!1;var map=new MapClass($dom,options);return map},exprt.parseLocation=function(address,callback){exprt.ready(function(){var geoclient=new google.maps.Geocoder;geoclient.geocode({address:address},function(results,status){status==google.maps.GeocoderStatus.OK&&callback&&callback(results[0].geometry.location,results[0].formatted_address)})})},window[globalName]=exprt}(jQuery),function($){if(!$)return console.error("jQuery needs to be loaded before the theme's Javscript"),!1;var $header,exprt={},renderLocationsModule=($(window),function(){var render=function(){var container=$(this),detailContainer=container.find(".js-location-container"),detailBack=detailContainer.find(".js-location-back, .button[href=#]"),detailDetails=detailContainer.find(".js-location-details"),detailMap=detailContainer.find(".js-location-map"),listContainer=container.find(".js-location-list-container"),itemsDOM=container.find(".js-location-expand-container"),itemsMap=container.find(".js-locations-all-map"),items=[],marker=container.attr("data-marker")||null,detailMapGObj=!1,mainMapGObj=!1;detailBack.on("click",function(e){e.preventDefault(),detailContainer.hide(),listContainer.show(),detailMapGObj&&detailMapGObj.reset(),positionPage(),mainMapGObj&&google.maps.event.trigger(mainMapGObj.map,"resize")});var positionPage=function(){window.scrollTo(0,container.offset().top-$header.height()-150)},loadItem=function(obj){detailContainer.show(),listContainer.hide(),detailDetails.html(obj.html),obj._foundAddr&&detailDetails.append("<hr />"+obj._foundAddr+'<br /><a href="https://maps.google.com?saddr=Current+Location&daddr='+obj._foundAddr+'" target="_blank">View Directions</a>'),positionPage(),detailMapGObj&&(google.maps.event.trigger(detailMapGObj.map,"resize"),obj._latlng?detailMapGObj.addMarker(obj._latlng,marker):FoodTruckGMap.parseLocation(obj.address,function(googLatLng){detailMapGObj.addMarker(googLatLng,marker)}))},loadAll=function(){itemsDOM.each(function(){var html=$(this).html(),address=$(this).find("script").html(),obj={address:address,html:html,_latlng:!1,_foundAddr:!1};items.push(obj),$(this).on("click",loadItem.bind(null,obj))}),items.length&&FoodTruckGMap.ready(function(){var windowWidth=window.innerWidth||document.documentElement.clientWidth;detailMapGObj=FoodTruckGMap.create(detailMap,{zoom:15,scrollwheel:windowWidth>980}),mainMapGObj=FoodTruckGMap.create(itemsMap,{scrollwheel:!1});for(var i=0;i<items.length;i++)items[i].address&&function(item){FoodTruckGMap.parseLocation(items[i].address,function(googLatLng,addr){item._latlng=googLatLng,item._foundAddr=addr,mainMapGObj.addMarker(googLatLng,marker,loadItem.bind(null,item))})}(items[i])})};loadAll(),itemsDOM.on("click",loadItem)};$(".js-location-module").each(function(){var container=$(this);container.data("_rendered")||(container.data("_rendered",!0),render.call(this))})});exprt.locationsMapReady=renderLocationsModule,window.FoodTruckFramework=exprt}(window.jQuery);
//# sourceMappingURL=main.js.map
